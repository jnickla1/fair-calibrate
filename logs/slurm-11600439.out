## SLURM PROLOG ###############################################################
##    Job ID : 11600439
##  Job Name : FAIR_Nsamp
##  Nodelist : node1954
##      CPUs : 40
##   Mem/CPU : 2800 MB
## Directory : /oscar/home/jnickla1/fair-calibrate
##   Job Started : Tue May 27 09:12:14 PM EDT 2025
###############################################################################
>>> Running calibration
  • calibration/01_tabulate-4xCO2.py
Making nice 4xCO2 data...
  • calibration/02_calibrate_cummins_3layer.r
Running R script for 3 layer model calibrations...
[1] "Success! Convergence achieved in 3879 iterations."
[1] "Success! Convergence achieved in 5405 iterations."
[1] "Success! Convergence achieved in 5920 iterations."
[1] "Success! Convergence achieved in 4286 iterations."
[1] "Success! Convergence achieved in 4364 iterations."
 [1] "Success! Convergence achieved in 5361 iterations."                       
 [2] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [3] "Variance of the prediction error can not be computed."                   
 [4] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [5] "Determinant of the variance of the prediction error can not be computed."
 [6] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [7] "Variance of the prediction error can not be computed."                   
 [8] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [9] "Determinant of the variance of the prediction error can not be computed."
[10] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[11] "Variance of the prediction error can not be computed."                   
[12] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[13] "Determinant of the variance of the prediction error can not be computed."
[14] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[15] "Variance of the prediction error can not be computed."                   
[16] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[17] "Determinant of the variance of the prediction error can not be computed."
[18] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[19] "Variance of the prediction error can not be computed."                   
[20] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[21] "Determinant of the variance of the prediction error can not be computed."
[22] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[23] "Variance of the prediction error can not be computed."                   
[24] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[25] "Determinant of the variance of the prediction error can not be computed."
[26] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[27] "Variance of the prediction error can not be computed."                   
[28] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[29] "Determinant of the variance of the prediction error can not be computed."
[30] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[31] "Variance of the prediction error can not be computed."                   
[32] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[33] "Determinant of the variance of the prediction error can not be computed."
[34] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[35] "Variance of the prediction error can not be computed."                   
[36] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[37] "Determinant of the variance of the prediction error can not be computed."
[38] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[39] "Variance of the prediction error can not be computed."                   
[40] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[41] "Determinant of the variance of the prediction error can not be computed."
[42] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[43] "Variance of the prediction error can not be computed."                   
[44] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[45] "Determinant of the variance of the prediction error can not be computed."
[1] "Success! Convergence achieved in 3968 iterations."
[1] "Success! Convergence achieved in 4907 iterations."
[1] "Success! Convergence achieved in 4985 iterations."
[1] "Success! Convergence achieved in 7089 iterations."
[1] "Success! Convergence achieved in 4589 iterations."
[1] "Success! Convergence achieved in 4434 iterations."
[1] "Success! Convergence achieved in 4172 iterations."
CNRM-CM6-1 did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  1e-05
[1] "Success! Convergence achieved in 10628 iterations."
[1] "Success! Convergence achieved in 10901 iterations."
[1] "Success! Convergence achieved in 5752 iterations."
[1] "Success! Convergence achieved in 5254 iterations."
[1] "Success! Convergence achieved in 6029 iterations."
[1] "Success! Convergence achieved in 3864 iterations."
[1] "Success! Convergence achieved in 4778 iterations."
[1] "Success! Convergence achieved in 5660 iterations."
[1] "Success! Convergence achieved in 7020 iterations."
[1] "Success! Convergence achieved in 6930 iterations."
[1] "Success! Convergence achieved in 4424 iterations."
[1] "Success! Convergence achieved in 7252 iterations."
[1] "Success! Convergence achieved in 8207 iterations."
[1] "Success! Convergence achieved in 6951 iterations."
[1] "Success! Convergence achieved in 5585 iterations."
 [1] "Success! Convergence achieved in 15337 iterations."                      
 [2] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
 [3] "Variance of the prediction error can not be computed."                   
 [4] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
 [5] "Determinant of the variance of the prediction error can not be computed."
 [6] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
 [7] "Variance of the prediction error can not be computed."                   
 [8] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
 [9] "Determinant of the variance of the prediction error can not be computed."
[10] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[11] "Variance of the prediction error can not be computed."                   
[12] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[13] "Determinant of the variance of the prediction error can not be computed."
[14] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[15] "Variance of the prediction error can not be computed."                   
[16] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[17] "Determinant of the variance of the prediction error can not be computed."
[18] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[19] "Variance of the prediction error can not be computed."                   
[20] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[21] "Determinant of the variance of the prediction error can not be computed."
[22] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[23] "Variance of the prediction error can not be computed."                   
[24] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[25] "Determinant of the variance of the prediction error can not be computed."
[26] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[27] "Variance of the prediction error can not be computed."                   
[28] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[29] "Determinant of the variance of the prediction error can not be computed."
[30] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[31] "Variance of the prediction error can not be computed."                   
[32] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[33] "Determinant of the variance of the prediction error can not be computed."
[34] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[35] "Variance of the prediction error can not be computed."                   
[36] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[37] "Determinant of the variance of the prediction error can not be computed."
[38] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[39] "Variance of the prediction error can not be computed."                   
[40] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[41] "Determinant of the variance of the prediction error can not be computed."
[42] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[43] "Variance of the prediction error can not be computed."                   
[44] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[45] "Determinant of the variance of the prediction error can not be computed."
FIO-ESM-2-0 did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  1e-05
FIO-ESM-2-0 did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  1e-04
FIO-ESM-2-0 did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  0.001
 [1] "Success! Convergence achieved in 8800 iterations."                       
 [2] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [3] "Variance of the prediction error can not be computed."                   
 [4] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [5] "Determinant of the variance of the prediction error can not be computed."
 [6] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [7] "Variance of the prediction error can not be computed."                   
 [8] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [9] "Determinant of the variance of the prediction error can not be computed."
[10] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[11] "Variance of the prediction error can not be computed."                   
[12] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[13] "Determinant of the variance of the prediction error can not be computed."
[14] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[15] "Variance of the prediction error can not be computed."                   
[16] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[17] "Determinant of the variance of the prediction error can not be computed."
[18] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[19] "Variance of the prediction error can not be computed."                   
[20] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[21] "Determinant of the variance of the prediction error can not be computed."
[22] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[23] "Variance of the prediction error can not be computed."                   
[24] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[25] "Determinant of the variance of the prediction error can not be computed."
[26] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[27] "Variance of the prediction error can not be computed."                   
[28] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[29] "Determinant of the variance of the prediction error can not be computed."
[30] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[31] "Variance of the prediction error can not be computed."                   
[32] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[33] "Determinant of the variance of the prediction error can not be computed."
[34] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[35] "Variance of the prediction error can not be computed."                   
[36] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[37] "Determinant of the variance of the prediction error can not be computed."
[38] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[39] "Variance of the prediction error can not be computed."                   
[40] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[41] "Determinant of the variance of the prediction error can not be computed."
[42] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[43] "Variance of the prediction error can not be computed."                   
[44] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[45] "Determinant of the variance of the prediction error can not be computed."
[1] "Success! Convergence achieved in 14086 iterations."
[1] "Success! Convergence achieved in 6765 iterations."
[1] "Success! Convergence achieved in 4875 iterations."
[1] "Success! Convergence achieved in 6400 iterations."
[1] "Success! Convergence achieved in 5798 iterations."
[1] "Success! Convergence achieved in 8151 iterations."
[1] "Success! Convergence achieved in 4937 iterations."
 [1] "Success! Convergence achieved in 6008 iterations."                       
 [2] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
 [3] "Variance of the prediction error can not be computed."                   
 [4] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
 [5] "Determinant of the variance of the prediction error can not be computed."
 [6] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [7] "Variance of the prediction error can not be computed."                   
 [8] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [9] "Determinant of the variance of the prediction error can not be computed."
[10] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[11] "Variance of the prediction error can not be computed."                   
[12] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[13] "Determinant of the variance of the prediction error can not be computed."
[14] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[15] "Variance of the prediction error can not be computed."                   
[16] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[17] "Determinant of the variance of the prediction error can not be computed."
[18] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[19] "Variance of the prediction error can not be computed."                   
[20] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[21] "Determinant of the variance of the prediction error can not be computed."
[22] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[23] "Variance of the prediction error can not be computed."                   
[24] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[25] "Determinant of the variance of the prediction error can not be computed."
[26] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[27] "Variance of the prediction error can not be computed."                   
[28] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[29] "Determinant of the variance of the prediction error can not be computed."
[30] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[31] "Variance of the prediction error can not be computed."                   
[32] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[33] "Determinant of the variance of the prediction error can not be computed."
[34] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[35] "Variance of the prediction error can not be computed."                   
[36] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[37] "Determinant of the variance of the prediction error can not be computed."
[38] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[39] "Variance of the prediction error can not be computed."                   
[40] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[41] "Determinant of the variance of the prediction error can not be computed."
[42] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[43] "Variance of the prediction error can not be computed."                   
[44] "Warning: Cholesky factorization 'dpotrf' exited with status: 2"          
[45] "Determinant of the variance of the prediction error can not be computed."
[1] "Success! Convergence achieved in 6667 iterations."
[1] "Success! Convergence achieved in 15817 iterations."
[1] "Success! Convergence achieved in 5769 iterations."
[1] "Success! Convergence achieved in 4278 iterations."
[1] "Success! Convergence achieved in 4735 iterations."
[1] "Success! Convergence achieved in 7304 iterations."
[1] "Success! Convergence achieved in 6220 iterations."
[1] "Success! Convergence achieved in 5110 iterations."
[1] "Success! Convergence achieved in 5746 iterations."
[1] "Success! Convergence achieved in 4949 iterations."
MIROC-ES2L did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  1e-05
[1] "Success! Convergence achieved in 14214 iterations."
[1] "Success! Convergence achieved in 14958 iterations."
[1] "Success! Convergence achieved in 5088 iterations."
[1] "Success! Convergence achieved in 6780 iterations."
[1] "Success! Convergence achieved in 5334 iterations."
[1] "Success! Convergence achieved in 4256 iterations."
[1] "Success! Convergence achieved in 5047 iterations."
[1] "Success! Convergence achieved in 4915 iterations."
[1] "Success! Convergence achieved in 4644 iterations."
[1] "Success! Convergence achieved in 4102 iterations."
[1] "Success! Convergence achieved in 5181 iterations."
[1] "Success! Convergence achieved in 12321 iterations."
[1] "Success! Convergence achieved in 4631 iterations."
 [1] "Success! Convergence achieved in 1270 iterations."                       
 [2] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [3] "Variance of the prediction error can not be computed."                   
 [4] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [5] "Determinant of the variance of the prediction error can not be computed."
 [6] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [7] "Variance of the prediction error can not be computed."                   
 [8] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
 [9] "Determinant of the variance of the prediction error can not be computed."
[10] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[11] "Variance of the prediction error can not be computed."                   
[12] "Warning: Cholesky factorization 'dpotrf' exited with status: 1"          
[13] "Determinant of the variance of the prediction error can not be computed."
NorESM2-MM did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  1e-05
NorESM2-MM did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  1e-04
NorESM2-MM did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  0.001
NorESM2-MM did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.Trying again with more liberal quadratic penalty (alpha) =  0.01
NorESM2-MM did not converge or ran out of iterations
Here's the original error message from FitKalman:
Iterations exhausted.This isn't going to work, is it? I'm giving up for NorESM2-MM
I am excluding NorESM2-MM  from my table of results.
[1] "Success! Convergence achieved in 5206 iterations."
[1] "Success! Convergence achieved in 5834 iterations."
[1] "Success! Convergence achieved in 6952 iterations."
Warning messages:
1: In sqrt(diag(vcov)) : NaNs produced
2: In sqrt(diag(vcov)) : NaNs produced
3: In sqrt(diag(vcov)) : NaNs produced
4: In sqrt(diag(vcov)) : NaNs produced
  • calibration/03_convert-ebm3-to-impulse-response.py
Converting EBM parameters to IRM parameters...
ACCESS-CM2 & 0.67 & 2.81 & 0.68 & 3.73 & 11.6 & 86 & 1.35 & 1.62 & 0.53 & 0.45 & 7.19 & 5.36 & 2.48 \\
ACCESS-ESM1-5 & 0.70 & 3.58 & 0.84 & 3.77 & 8.9 & 87 & 1.56 & 2.74 & 0.60 & 0.64 & 6.56 & 4.69 & 2.00 \\
AWI-CM-1-1-MR & 1.22 & 1.79 & 0.66 & 4.14 & 11.0 & 47 & 1.32 & 3.97 & 0.65 & 0.94 & 8.02 & 3.28 & 2.17 \\
BCC-CSM2-MR & 1.06 & 2.13 & 0.85 & 4.16 & 11.8 & 63 & 1.25 & 2.30 & 0.34 & 0.54 & 6.71 & 3.15 & 1.87 \\
BCC-ESM1 & 0.88 & 1.48 & 0.91 & 5.35 & 15.8 & 77 & 1.29 & 1.88 & 0.31 & 0.39 & 6.25 & 3.53 & 1.91 \\
CAMS-CSM1-0 & 1.88 & 5.73 & 0.63 & 2.15 & 9.4 & 53 & 1.26 & 31.85 & 0.42 & 2.85 & 8.85 & 2.36 & 1.73 \\
CAS-ESM2-0 & 0.93 & 2.50 & 0.67 & 3.56 & 8.6 & 55 & 1.33 & 1.89 & 0.41 & 0.52 & 6.97 & 3.74 & 2.18 \\
CESM2 & 0.65 & 3.88 & 0.90 & 4.83 & 6.4 & 71 & 1.68 & 2.80 & 0.49 & 0.71 & 8.18 & 6.29 & 2.49 \\
CESM2-FV2 & 0.54 & 4.01 & 1.01 & 3.86 & 7.0 & 86 & 1.75 & 2.71 & 0.61 & 0.88 & 7.36 & 6.84 & 2.24 \\
CESM2-WACCM & 0.72 & 7.33 & 0.84 & 3.82 & 6.2 & 85 & 1.59 & 2.98 & 0.51 & 0.70 & 8.07 & 5.60 & 2.31 \\
CESM2-WACCM-FV2 & 0.56 & 3.52 & 0.94 & 3.39 & 9.5 & 107 & 1.50 & 2.89 & 0.53 & 0.94 & 6.73 & 5.98 & 2.16 \\
CIESM & 0.68 & 2.65 & 1.00 & 5.28 & 11.6 & 69 & 1.35 & 0.81 & 0.55 & 0.36 & 8.48 & 6.26 & 2.69 \\
CMCC-CM2-SR5 & 1.08 & 2.20 & 0.72 & 3.45 & 11.4 & 53 & 1.29 & 25.82 & 0.80 & 2.71 & 8.09 & 3.74 & 2.30 \\
CNRM-CM6-1 & 0.78 & 1.56 & 0.67 & 3.21 & 16.1 & 116 & 0.91 & 23.95 & 0.47 & 1.67 & 7.32 & 4.70 & 2.66 \\
CNRM-CM6-1-HR & 0.94 & 1.99 & 0.65 & 4.16 & 11.8 & 90 & 0.80 & 7.10 & 0.48 & 0.69 & 7.70 & 4.10 & 2.57 \\
CNRM-ESM2-1 & 0.68 & 2.62 & 0.69 & 3.53 & 7.6 & 104 & 0.83 & 4.67 & 0.50 & 0.89 & 5.90 & 4.35 & 2.39 \\
CanESM5 & 0.62 & 2.48 & 0.61 & 3.63 & 10.6 & 73 & 1.12 & 2.62 & 0.48 & 0.42 & 7.33 & 5.93 & 2.92 \\
E3SM-1-0 & 0.58 & 2.37 & 0.37 & 3.65 & 9.6 & 42 & 1.49 & 3.07 & 0.60 & 0.91 & 7.05 & 6.03 & 3.10 \\
EC-Earth3 & 0.82 & 2.68 & 0.56 & 3.21 & 10.5 & 34 & 1.26 & 26.83 & 0.73 & 2.33 & 7.14 & 4.34 & 2.53 \\
EC-Earth3-Veg & 0.84 & 2.30 & 0.59 & 3.23 & 10.5 & 31 & 1.28 & 25.15 & 0.69 & 2.64 & 7.50 & 4.47 & 2.65 \\
FGOALS-f3-L & 1.45 & 5.96 & 0.72 & 1.81 & 10.2 & 70 & 1.49 & 28.53 & 0.61 & 2.68 & 9.34 & 3.23 & 2.02 \\
FGOALS-g3 & 1.26 & 2.84 & 0.91 & 4.07 & 7.8 & 91 & 1.26 & 1.20 & 0.44 & 0.24 & 7.65 & 3.04 & 1.86 \\
FIO-ESM-2-0 & 0.87 & 4.63 & 0.87 & 3.01 & 8.4 & 91 & 1.32 & 31.06 & 0.60 & 1.77 & 8.13 & 4.66 & 2.31 \\
GFDL-CM4 & 1.00 & 2.51 & 1.37 & 5.31 & 0.2 & 81 & 1.81 & 2.73 & 0.71 & 0.96 & 9.02 & 4.49 & 2.19 \\
GFDL-ESM4 & 1.38 & 1.92 & 0.84 & 4.32 & 10.6 & 124 & 1.02 & 4.32 & 0.49 & 1.07 & 7.36 & 2.66 & 1.79 \\
GISS-E2-1-G & 1.44 & 2.09 & 1.20 & 3.59 & 10.6 & 163 & 1.09 & 2.89 & 0.66 & 0.53 & 8.02 & 2.78 & 1.76 \\
GISS-E2-1-H & 1.11 & 4.31 & 0.78 & 2.24 & 9.7 & 78 & 1.19 & 3.62 & 0.59 & 0.55 & 7.20 & 3.25 & 1.93 \\
GISS-E2-2-G & 1.97 & 1.92 & 0.63 & 3.60 & 11.3 & 314 & 0.44 & 2.39 & 0.54 & 0.54 & 8.04 & 2.04 & 1.68 \\
HadGEM3-GC31-LL & 0.61 & 2.85 & 0.64 & 3.87 & 9.3 & 66 & 1.17 & 3.13 & 0.61 & 0.46 & 7.22 & 5.91 & 2.83 \\
HadGEM3-GC31-MM & 0.65 & 2.01 & 0.69 & 3.40 & 14.1 & 65 & 1.04 & 3.13 & 0.43 & 0.50 & 7.16 & 5.54 & 2.77 \\
IITM-ESM & 1.99 & 2.80 & 1.00 & 3.76 & 12.0 & 150 & 1.06 & 2.95 & 0.54 & 1.15 & 9.43 & 2.37 & 1.67 \\
INM-CM4-8 & 1.58 & 1.90 & 0.55 & 4.35 & 9.8 & 22 & 1.45 & 2.51 & 0.26 & 0.44 & 5.94 & 1.88 & 1.41 \\
INM-CM5-0 & 1.54 & 1.90 & 0.58 & 4.58 & 11.4 & 49 & 1.45 & 1.92 & 0.32 & 0.44 & 6.23 & 2.02 & 1.42 \\
IPSL-CM6A-LR & 0.72 & 1.76 & 0.48 & 3.40 & 13.2 & 62 & 1.28 & 3.22 & 0.49 & 0.90 & 7.05 & 4.90 & 2.70 \\
KACE-1-0-G & 0.73 & 3.63 & 0.87 & 2.54 & 8.7 & 101 & 1.25 & 2.08 & 0.35 & 0.36 & 7.80 & 5.36 & 2.50 \\
KIOST-ESM & 0.93 & 3.05 & 0.95 & 2.15 & 9.6 & 95 & 1.41 & 2.35 & 0.32 & 0.61 & 7.22 & 3.87 & 1.99 \\
MIROC-ES2L & 1.95 & 1.71 & 0.70 & 4.56 & 16.6 & 204 & 0.45 & 1.95 & 0.95 & 0.71 & 8.81 & 2.25 & 1.78 \\
MIROC6 & 2.00 & 1.20 & 0.60 & 4.27 & 22.9 & 350 & 0.38 & 1.86 & 0.89 & 0.71 & 8.57 & 2.15 & 1.71 \\
MPI-ESM-1-2-HAM & 1.30 & 2.14 & 0.97 & 4.93 & 14.6 & 105 & 1.38 & 2.54 & 0.49 & 0.55 & 8.48 & 3.27 & 1.94 \\
MPI-ESM1-2-HR & 1.17 & 1.59 & 1.11 & 5.12 & 23.6 & 73 & 1.56 & 3.49 & 0.44 & 0.57 & 7.82 & 3.34 & 1.89 \\
MPI-ESM1-2-LR & 1.40 & 1.95 & 1.07 & 5.15 & 10.7 & 95 & 1.26 & 2.40 & 0.71 & 0.47 & 8.93 & 3.19 & 2.01 \\
MRI-ESM2-0 & 1.11 & 2.85 & 1.25 & 4.24 & 10.5 & 94 & 1.33 & 2.99 & 0.52 & 0.98 & 7.56 & 3.41 & 1.80 \\
NESM3 & 0.96 & 1.05 & 0.48 & 2.49 & 19.2 & 126 & 0.72 & 2.80 & 0.27 & 0.55 & 8.15 & 4.23 & 2.85 \\
NorCPM1 & 1.03 & 2.07 & 1.33 & 5.72 & 17.6 & 92 & 1.51 & 1.81 & 0.50 & 0.49 & 7.26 & 3.52 & 1.75 \\
NorESM2-LM & 1.61 & 2.71 & 1.28 & 4.45 & 0.1 & 122 & 1.15 & 1.71 & 0.71 & 1.35 & 8.17 & 2.53 & 1.67 \\
SAM0-UNICON & 1.04 & 2.69 & 1.03 & 4.63 & 6.3 & 111 & 1.25 & 2.44 & 0.64 & 0.80 & 8.36 & 4.01 & 2.20 \\
TaiESM1 & 0.87 & 2.31 & 0.92 & 5.06 & 9.0 & 91 & 1.23 & 2.04 & 0.69 & 0.46 & 8.15 & 4.67 & 2.44 \\
UKESM1-0-LL & 0.66 & 2.60 & 0.61 & 2.92 & 11.3 & 73 & 1.13 & 3.55 & 0.44 & 0.50 & 7.38 & 5.63 & 2.84 \\
  • calibration/04_get-primap-emissions.py
Getting PRIMAP data...
  • calibration/05_get-gfed-emissions.py
/oscar/home/jnickla1/fair-calibrate/input/fair-2.1.3/v1.4/all_current_NorESMVolc/calibration/./05_get-gfed-emissions.py:90: FutureWarning: The 'delim_whitespace' keyword in pd.read_csv is deprecated and will be removed in a future version. Use ``sep='\s+'`` instead
  efs = pd.read_csv(
Getting GFED data...
[[6.05880707e+03 5.95110042e+03 4.56516052e+03 ... 4.02663307e+03
  4.39033080e+03 3.32541162e+03]
 [3.03199204e+03 2.89289675e+03 2.22675170e+03 ... 1.95754281e+03
  2.12262022e+03 1.61723903e+03]
 [1.00952568e+04 9.80862444e+03 7.58979063e+03 ... 6.64918238e+03
  7.15593915e+03 5.49945142e+03]
 ...
 [2.04808944e+00 1.71651457e+00 1.23963623e+00 ... 1.08693472e+00
  1.12870716e+00 9.13056741e-01]
 [4.42292916e+00 4.34430331e+00 3.33256718e+00 ... 2.93944214e+00
  3.20494148e+00 2.42755048e+00]
 [2.96116950e+00 2.69412973e+00 1.83023867e+00 ... 1.80337132e+00
  2.17020216e+00 1.41097104e+00]]
  • calibration/06_get-extend-ceds-emissions.py
Making SLCF emissions...
  • calibration/07_make-slcf-emissions.py
Making SLCF emissions...
  • calibration/08_decompose-hfc-pfc.py
  • calibration/09_invert-montreal-concentrations.py
Calculating historical equivalent emissions...
  • calibration/10_combine-emissions.py
Combining GCP, CEDS, PRIMAP, GFED data into one file...
         Model              Scenario  ...         2021         2022
0   Historical  GCP+CEDS+PRIMAP+GFED  ...    36.817125    37.150372
1   Historical  GCP+CEDS+PRIMAP+GFED  ...     4.321646     4.310019
2   Historical  GCP+CEDS+PRIMAP+GFED  ...   380.812635   378.405896
3   Historical  GCP+CEDS+PRIMAP+GFED  ...    11.947988    11.675409
4   Historical  GCP+CEDS+PRIMAP+GFED  ...      9.55623     9.788947
5   Historical  GCP+CEDS+PRIMAP+GFED  ...     0.164883     0.175691
6   Historical  GCP+CEDS+PRIMAP+GFED  ...    72.315118    76.861223
7   Historical  GCP+CEDS+PRIMAP+GFED  ...    839.08517   758.190637
8   Historical  GCP+CEDS+PRIMAP+GFED  ...   205.076396   188.408051
9   Historical  GCP+CEDS+PRIMAP+GFED  ...   122.898373   131.678232
10  Historical  GCP+CEDS+PRIMAP+GFED  ...     6.871947     6.701702
11  Historical  GCP+CEDS+PRIMAP+GFED  ...    33.619623     25.61281
12  Historical  GCP+CEDS+PRIMAP+GFED  ...    66.400232    65.232056
13  Historical  GCP+CEDS+PRIMAP+GFED  ...    57.118825    57.118825
14  Historical  GCP+CEDS+PRIMAP+GFED  ...    28.023867    28.023867
15  Historical  GCP+CEDS+PRIMAP+GFED  ...     6.298342     6.298342
16  Historical  GCP+CEDS+PRIMAP+GFED  ...     2.763164     2.763164
17  Historical  GCP+CEDS+PRIMAP+GFED  ...     2.102991     2.102991
18  Historical  GCP+CEDS+PRIMAP+GFED  ...   350.935915   350.935915
19  Historical  GCP+CEDS+PRIMAP+GFED  ...    55.029222    55.029222
20  Historical  GCP+CEDS+PRIMAP+GFED  ...    21.494075    21.494075
21  Historical  GCP+CEDS+PRIMAP+GFED  ...    34.748115    34.748115
22  Historical  GCP+CEDS+PRIMAP+GFED  ...   370.433593   370.433593
23  Historical  GCP+CEDS+PRIMAP+GFED  ...  1229.025703  1229.025703
24  Historical  GCP+CEDS+PRIMAP+GFED  ...  5340.361242  5340.361242
25  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.191933     0.191933
26  Historical  GCP+CEDS+PRIMAP+GFED  ...   135.135504   135.135504
27  Historical  GCP+CEDS+PRIMAP+GFED  ...     3.534761     3.534761
28  Historical  GCP+CEDS+PRIMAP+GFED  ...     1.881336     1.881336
29  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.358827     0.358827
30  Historical  GCP+CEDS+PRIMAP+GFED  ...     3.148596     3.148596
31  Historical  GCP+CEDS+PRIMAP+GFED  ...   142.551933   147.896677
32  Historical  GCP+CEDS+PRIMAP+GFED  ...   205.347411   202.991074
33  Historical  GCP+CEDS+PRIMAP+GFED  ...    51.815017    53.655721
34  Historical  GCP+CEDS+PRIMAP+GFED  ...    47.760643    46.152016
35  Historical  GCP+CEDS+PRIMAP+GFED  ...     4.432262     4.454464
36  Historical  GCP+CEDS+PRIMAP+GFED  ...     1.946462      1.79613
37  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.385853     0.398941
38  Historical  GCP+CEDS+PRIMAP+GFED  ...    17.377753     17.96753
39  Historical  GCP+CEDS+PRIMAP+GFED  ...     5.183944     4.783573
40  Historical  GCP+CEDS+PRIMAP+GFED  ...     4.727321     4.673073
41  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.984248     0.951097
42  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.770842     0.775198
43  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.219866     0.221109
44  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.048805     0.049079
45  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.021369     0.021488
46  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.171865     0.172831
47  Historical  GCP+CEDS+PRIMAP+GFED  ...      0.11481     0.115458
48  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.049804     0.050084
49  Historical  GCP+CEDS+PRIMAP+GFED  ...     5.337053     5.367179
50  Historical  GCP+CEDS+PRIMAP+GFED  ...     0.622162     0.625677

[51 rows x 278 columns]
  • calibration/11_non-ch4-scale-factor.py
Calibrating GHG emissions scale factors...
  • calibration/12_harmonize-emissions.py
Making harmonized SSP emissions binary...
  • calibration/13_check-scalings.py
Sense check of harmonized scalings...
  • calibration/14_methane-lifetime-multispecies.py
Calibrating methane lifetime...
CH4 1023.2219696044921
N2O 53.96694437662762
VOC 166.74246925530488
NOx 142.33343257853136
HC 1126.2579463492486
{'base': 8, 'CH4': 0.22, 'NOx': -0.25, 'VOC': 0.11, 'HC': -0.049, 'N2O': -0.012, 'temp': -0.0408}
{'base': 9.6, 'CH4': 0.21, 'NOx': -0.33, 'VOC': 0.15, 'HC': -0.075, 'N2O': 0, 'temp': -0.0205}
{'base': 13.4, 'CH4': 0.18, 'NOx': -0.46, 'VOC': 0.27, 'HC': -0.006, 'N2O': -0.039, 'temp': -0.0333}
{'base': 10.1, 'CH4': 0.22, 'NOx': -0.26, 'VOC': 0.21, 'HC': -0.024, 'N2O': -0.013, 'temp': 0}
{'base': np.float64(16.949999999998774), 'CH4': np.float64(0.17184648617466725), 'NOx': np.float64(-0.43379804774395575), 'VOC': np.float64(0.03000000000000973), 'HC': np.float64(0.028499999999999973), 'N2O': np.float64(-0.05249999999999999), 'temp': np.float64(-0.046299999999999994)}
CH4 0.00016925302211677194
NOx -0.0034241610295753467
VOC 0.00019836965091554588
HC 2.5314611423864167e-05
N2O -0.0009498909887008204
methane lifetime 1750: 16.785833821501047
methane lifetime 1850: 16.949999999998774
  • calibration/15_landuse-scaling.py
Calculating land use scale factor...
  • calibration/16_lapsi-scaling.py
Calculating land use scale factor...
>>> Running sampling
  • sampling/01_climate-response-sampling-ebm3.py
Making climate response calibrations...
ACCESS-CM2 ['r1i1p1f1']
ACCESS-ESM1-5 ['r1i1p1f1']
AWI-CM-1-1-MR ['r1i1p1f1']
BCC-CSM2-MR ['r1i1p1f1']
BCC-ESM1 ['r1i1p1f1']
CAMS-CSM1-0 ['r1i1p1f1']
CAS-ESM2-0 ['r1i1p1f1']
CESM2 ['r1i1p1f1']
CESM2-FV2 ['r1i1p1f1']
CESM2-WACCM ['r1i1p1f1']
CESM2-WACCM-FV2 ['r1i1p1f1']
CIESM ['r1i1p1f1']
CMCC-CM2-SR5 ['r1i1p1f1']
CNRM-CM6-1 ['r1i1p1f2']
CNRM-CM6-1-HR ['r1i1p1f2']
CNRM-ESM2-1 ['r1i1p1f2' 'r2i1p1f2' 'r3i1p1f2']
CanESM5 ['r1i1p1f1' 'r1i1p2f1']
E3SM-1-0 ['r1i1p1f1']
EC-Earth3 ['r3i1p1f1' 'r8i1p1f1']
EC-Earth3-Veg ['r1i1p1f1']
FGOALS-f3-L ['r1i1p1f1' 'r2i1p1f1' 'r3i1p1f1']
FGOALS-g3 ['r1i1p1f1']
FIO-ESM-2-0 ['r1i1p1f1' 'r2i1p1f1' 'r3i1p1f1']
GFDL-CM4 ['r1i1p1f1']
GFDL-ESM4 ['r1i1p1f1']
GISS-E2-1-G ['r102i1p1f1' 'r1i1p1f1' 'r1i1p3f1' 'r1i1p5f1']
GISS-E2-1-H ['r1i1p1f1' 'r1i1p3f1']
GISS-E2-2-G ['r1i1p1f1']
HadGEM3-GC31-LL ['r1i1p1f3']
HadGEM3-GC31-MM ['r1i1p1f3']
IITM-ESM ['r1i1p1f1']
INM-CM4-8 ['r1i1p1f1']
INM-CM5-0 ['r1i1p1f1']
IPSL-CM6A-LR ['r1i1p1f1']
KACE-1-0-G ['r1i1p1f1']
KIOST-ESM ['r1i1p1f1']
MIROC-ES2L ['r1i1p1f2']
MIROC6 ['r1i1p1f1']
MPI-ESM-1-2-HAM ['r1i1p1f1']
MPI-ESM1-2-HR ['r1i1p1f1']
MPI-ESM1-2-LR ['r1i1p1f1']
MRI-ESM2-0 ['r10i1p1f1' 'r13i1p1f1' 'r1i1p1f1' 'r1i2p1f1' 'r4i1p1f1' 'r7i1p1f1']
NESM3 ['r1i1p1f1']
NorCPM1 ['r1i1p1f1']
NorESM2-LM ['r1i1p1f1']
SAM0-UNICON ['r1i1p1f1']
TaiESM1 ['r1i1p1f1']
UKESM1-0-LL ['r1i1p1f2']
                 $\gamma$     $c_1$  ...  $\sigma_{\xi}$  $F_{4\times}$
$\gamma$         1.000000 -0.485683  ...        0.187356       0.204906
$c_1$           -0.485683  1.000000  ...        0.164323       0.030783
$c_2$           -0.019399  0.080153  ...       -0.091481      -0.017626
$c_3$           -0.230041  0.065542  ...        0.345101       0.341516
$\kappa_1$       0.046779  0.084064  ...        0.221073       0.453542
$\kappa_2$       0.343796 -0.422618  ...       -0.008306       0.214538
$\kappa_3$      -0.258407  0.489193  ...        0.127682       0.299690
$\epsilon$       0.025966  0.153980  ...       -0.200733      -0.131057
$\sigma_{\eta}$  0.913538 -0.434512  ...        0.326778       0.283388
$\sigma_{\xi}$   0.187356  0.164323  ...        1.000000       0.482406
$F_{4\times}$    0.204906  0.030783  ...        0.482406       1.000000

[11 rows x 11 columns]
Total number of retained samples: 2837564
  • sampling/02_erfaci-sampling-smith2023.py
Sampling aerosol cloud interactions...
Correlation coefficients between aci parameters
           aci_scale    Sulfur        BC        OC
aci_scale   1.000000  0.263441  0.152530  0.122842
Sulfur      0.263441  1.000000 -0.068510  0.880731
BC          0.152530 -0.068510  1.000000 -0.130581
OC          0.122842  0.880731 -0.130581  1.000000
  • sampling/03_erfari-sampling-ar6ch6.py
BC                                             0.025453
CH4                                           -0.000002
N2O                                           -0.000034
NH3                                           -0.000566
NOx                                           -0.000075
OC                                            -0.003948
Sulfur                                        -0.002805
VOC                                           -0.000016
Equivalent effective stratospheric chlorine   -0.000008
dtype: float64
BC                                             0.027965
CH4                                            0.000002
N2O                                            0.000033
NH3                                            0.000081
NOx                                            0.000037
OC                                             0.003582
Sulfur                                         0.002682
VOC                                            0.000031
Equivalent effective stratospheric chlorine    0.000002
dtype: float64
               BC  ...  Equivalent effective stratospheric chlorine
0        0.041833  ...                                    -0.000009
1        0.031921  ...                                    -0.000009
2        0.018328  ...                                    -0.000009
3        0.016425  ...                                    -0.000008
4        0.033695  ...                                    -0.000009
...           ...  ...                                          ...
1599995  0.003725  ...                                    -0.000009
1599996  0.026079  ...                                    -0.000010
1599997  0.029233  ...                                    -0.000009
1599998  0.010409  ...                                    -0.000007
1599999  0.049504  ...                                    -0.000008

[1600000 rows x 9 columns]
  • sampling/04_carbon-cycle-sampling-leach2021.py
Making carbon cycle calibrations...
  • sampling/05_ozone-sampling-ar6.py
Doing ozone sampling...
2014-1750 ozone ERF from Skeie: 0.5011812440611364
2019-1750 ozone ERF from Skeie: 0.5043812440611365
2014-1850 ozone ERF from Skeie: 0.4711812440611364
[ 2.35309435e-04  1.18260497e-03 -5.60752914e-05  2.33948866e-05
  2.82914126e-04  1.19235643e-03]
[6.19235356e-05 4.73041987e-04 1.20314921e-04 1.33348129e-04
 3.67559590e-04 1.16759382e-03]
  • sampling/06_forcing-uncertainty-ar6.py
Doing forcing uncertainty sampling...
  • sampling/07_CO2-1750-sampling-ar6ch2.py
Sampling 1750 CO2 concentration...
  • sampling/08_make-1pctCO2-concentration-binary.py
Making 1pctCO2 concentration binary...
  • sampling/09_run-fair-ssp-prior-ensemble-ebm3-intvar.py
Running the priors (could take a while)...
Traceback (most recent call last):
  File "/oscar/home/jnickla1/fair-calibrate/input/fair-2.1.3/v1.4/all_current_NorESMVolc/sampling/./09_run-fair-ssp-prior-ensemble-ebm3-intvar.py", line 42, in <module>
    ens_run = int(os.getenv("ENSEMBLE_RUN")) #starts at 1
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
ERROR in 09_run-fair-ssp-prior-ensemble-ebm3-intvar.py
